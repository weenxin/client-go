
## WorkQueue

K8s的采用声明式设计模式，与命令式不同的是，如果一个服务当前又3个节点，期望扩容为5个节点，两种设计模式的描述语句是不同的：
- 声明式： 保证服务有5个工作节点
- 命令式： 向服务增加两个节点

声明式的编程模式的优势在于，按照这种设计模式编写的模块和代码都是幂等的，所以在处理失败重试，`controller`节点挂掉等异常情况相对简单。

`WorkQueue` 这一章主要聚焦在限流和事件队列上。

- 限流器： 令牌桶的实现机制
- 队列： 实现了一个生命式的工作队列，区分为Processing，Queue，Dirty，当同一个对象多次更新放入队列时，只会触发一次处理流程；
- 条件变量： 一个不是很常用的加锁方式
- 延时队列： 当当前情况不适合执行指定操作，或者当前失败需要后续重试时，可以稍后执行相关动作的队列实现；
- 限流延时队列： 限流器与延时队列的组合
- 并行函数： 分片并行执行Util函数


详细内容见：

- [令牌桶](/ch1/rate.md)
- [限流器](/ch1/default-rate-limiter.md)
- [队列](/ch1/queue.md)
- [条件变量](/ch1/cond.md)
- [延时队列](/ch1/delaying-queue.md)
- [限流延时队列](/ch1/delaying-queue.md)
- [并行函数](/ch1/parallelizer.md)
